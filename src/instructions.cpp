#include "instructions.hpp"

#include "cpu.hpp"


struct Instruction instructionLookupTable[256];


void initInstrLookupTable()
{
    for (auto& inst: instructionLookupTable)
        inst = { "???", &Cpu::OpNOP, &Cpu::AddrIMP, 2 };

    instructionLookupTable[0x00] = { "BRK", &Cpu::OpBRK, &Cpu::AddrIMP, 7 };
    instructionLookupTable[0x01] = { "ORA", &Cpu::OpORA, &Cpu::AddrIZX, 6 };
    instructionLookupTable[0x05] = { "ORA", &Cpu::OpORA, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0x06] = { "ASL", &Cpu::OpASL, &Cpu::AddrZP0, 5 };
    instructionLookupTable[0x08] = { "PHP", &Cpu::OpPHP, &Cpu::AddrIMP, 3 };
    instructionLookupTable[0x09] = { "ORA", &Cpu::OpORA, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0x0A] = { "ASL", &Cpu::OpASL, &Cpu::AddrACC, 2 };
    instructionLookupTable[0x0D] = { "ORA", &Cpu::OpORA, &Cpu::AddrABS, 4 };
    instructionLookupTable[0x0E] = { "ASL", &Cpu::OpASL, &Cpu::AddrABS, 6 };
    instructionLookupTable[0x10] = { "BPL", &Cpu::OpBPL, &Cpu::AddrREL, 2 };
    instructionLookupTable[0x11] = { "ORA", &Cpu::OpORA, &Cpu::AddrIZY, 5 };
    instructionLookupTable[0x15] = { "ORA", &Cpu::OpORA, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0x16] = { "ASL", &Cpu::OpASL, &Cpu::AddrZPX, 6 };
    instructionLookupTable[0x18] = { "CLC", &Cpu::OpCLC, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0x19] = { "ORA", &Cpu::OpORA, &Cpu::AddrABY, 4 };
    instructionLookupTable[0x1D] = { "ORA", &Cpu::OpORA, &Cpu::AddrABX, 4 };
    instructionLookupTable[0x1E] = { "ASL", &Cpu::OpASL, &Cpu::AddrABX, 7 };
    instructionLookupTable[0x20] = { "JSR", &Cpu::OpJSR, &Cpu::AddrABS, 6 };
    instructionLookupTable[0x21] = { "AND", &Cpu::OpAND, &Cpu::AddrIZX, 6 };
    instructionLookupTable[0x24] = { "BIT", &Cpu::OpBIT, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0x25] = { "AND", &Cpu::OpAND, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0x26] = { "ROL", &Cpu::OpROL, &Cpu::AddrZP0, 5 };
    instructionLookupTable[0x28] = { "PLP", &Cpu::OpPLP, &Cpu::AddrIMP, 4 };
    instructionLookupTable[0x29] = { "AND", &Cpu::OpAND, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0x2A] = { "ROL", &Cpu::OpROL, &Cpu::AddrACC, 2 };
    instructionLookupTable[0x2C] = { "BIT", &Cpu::OpBIT, &Cpu::AddrABS, 4 };
    instructionLookupTable[0x2D] = { "AND", &Cpu::OpAND, &Cpu::AddrABS, 4 };
    instructionLookupTable[0x2E] = { "ROL", &Cpu::OpROL, &Cpu::AddrABS, 6 };
    instructionLookupTable[0x30] = { "BMI", &Cpu::OpBMI, &Cpu::AddrREL, 2 };
    instructionLookupTable[0x31] = { "AND", &Cpu::OpAND, &Cpu::AddrIZY, 5 };
    instructionLookupTable[0x35] = { "AND", &Cpu::OpAND, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0x36] = { "ROL", &Cpu::OpROL, &Cpu::AddrZPX, 6 };
    instructionLookupTable[0x38] = { "SEC", &Cpu::OpSEC, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0x39] = { "AND", &Cpu::OpAND, &Cpu::AddrABY, 4 };
    instructionLookupTable[0x3D] = { "AND", &Cpu::OpAND, &Cpu::AddrABX, 4 };
    instructionLookupTable[0x3E] = { "ROL", &Cpu::OpROL, &Cpu::AddrABX, 7 };
    instructionLookupTable[0x40] = { "RTI", &Cpu::OpRTI, &Cpu::AddrIMP, 6 };
    instructionLookupTable[0x41] = { "EOR", &Cpu::OpEOR, &Cpu::AddrIZX, 6 };
    instructionLookupTable[0x45] = { "EOR", &Cpu::OpEOR, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0x46] = { "LSR", &Cpu::OpLSR, &Cpu::AddrZP0, 5 };
    instructionLookupTable[0x48] = { "PHA", &Cpu::OpPHA, &Cpu::AddrIMP, 3 };
    instructionLookupTable[0x49] = { "EOR", &Cpu::OpEOR, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0x4A] = { "LSR", &Cpu::OpLSR, &Cpu::AddrACC, 2 };
    instructionLookupTable[0x4C] = { "JMP", &Cpu::OpJMP, &Cpu::AddrABS, 3 };
    instructionLookupTable[0x4D] = { "EOR", &Cpu::OpEOR, &Cpu::AddrABS, 4 };
    instructionLookupTable[0x4E] = { "LSR", &Cpu::OpLSR, &Cpu::AddrABS, 6 };
    instructionLookupTable[0x50] = { "BVC", &Cpu::OpBVC, &Cpu::AddrREL, 2 };
    instructionLookupTable[0x51] = { "EOR", &Cpu::OpEOR, &Cpu::AddrIZY, 5 };
    instructionLookupTable[0x55] = { "EOR", &Cpu::OpEOR, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0x56] = { "LSR", &Cpu::OpLSR, &Cpu::AddrZPX, 6 };
    instructionLookupTable[0x58] = { "CLI", &Cpu::OpCLI, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0x59] = { "EOR", &Cpu::OpEOR, &Cpu::AddrABY, 4 };
    instructionLookupTable[0x5D] = { "EOR", &Cpu::OpEOR, &Cpu::AddrABX, 4 };
    instructionLookupTable[0x5E] = { "LSR", &Cpu::OpLSR, &Cpu::AddrABX, 7 };
    instructionLookupTable[0x60] = { "RTS", &Cpu::OpRTS, &Cpu::AddrIMP, 6 };
    instructionLookupTable[0x61] = { "ADC", &Cpu::OpADC, &Cpu::AddrIZX, 6 };
    instructionLookupTable[0x65] = { "ADC", &Cpu::OpADC, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0x66] = { "ROR", &Cpu::OpROR, &Cpu::AddrZP0, 5 };
    instructionLookupTable[0x68] = { "PLA", &Cpu::OpPLA, &Cpu::AddrIMP, 4 };
    instructionLookupTable[0x69] = { "ADC", &Cpu::OpADC, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0x6A] = { "ROR", &Cpu::OpROR, &Cpu::AddrACC, 2 };
    instructionLookupTable[0x6C] = { "JMP", &Cpu::OpJMP, &Cpu::AddrIND, 5 };
    instructionLookupTable[0x6D] = { "ADC", &Cpu::OpADC, &Cpu::AddrABS, 4 };
    instructionLookupTable[0x6E] = { "ROR", &Cpu::OpROR, &Cpu::AddrABS, 6 };
    instructionLookupTable[0x70] = { "BVS", &Cpu::OpBVS, &Cpu::AddrREL, 2 };
    instructionLookupTable[0x71] = { "ADC", &Cpu::OpADC, &Cpu::AddrIZY, 5 };
    instructionLookupTable[0x75] = { "ADC", &Cpu::OpADC, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0x76] = { "ROR", &Cpu::OpROR, &Cpu::AddrZPX, 6 };
    instructionLookupTable[0x78] = { "SEI", &Cpu::OpSEI, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0x79] = { "ADC", &Cpu::OpADC, &Cpu::AddrABY, 4 };
    instructionLookupTable[0x7D] = { "ADC", &Cpu::OpADC, &Cpu::AddrABX, 4 };
    instructionLookupTable[0x7E] = { "ROR", &Cpu::OpROR, &Cpu::AddrABX, 7 };
    instructionLookupTable[0x81] = { "STA", &Cpu::OpSTA, &Cpu::AddrIZX, 6 };
    instructionLookupTable[0x84] = { "STY", &Cpu::OpSTY, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0x85] = { "STA", &Cpu::OpSTA, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0x86] = { "STX", &Cpu::OpSTX, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0x88] = { "DEY", &Cpu::OpDEY, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0x8A] = { "TXA", &Cpu::OpTXA, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0x8C] = { "STY", &Cpu::OpSTY, &Cpu::AddrABS, 4 };
    instructionLookupTable[0x8D] = { "STA", &Cpu::OpSTA, &Cpu::AddrABS, 4 };
    instructionLookupTable[0x8E] = { "STX", &Cpu::OpSTX, &Cpu::AddrABS, 4 };
    instructionLookupTable[0x90] = { "BCC", &Cpu::OpBCC, &Cpu::AddrREL, 2 };
    instructionLookupTable[0x91] = { "STA", &Cpu::OpSTA, &Cpu::AddrIZY, 6 };
    instructionLookupTable[0x94] = { "STY", &Cpu::OpSTY, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0x95] = { "STA", &Cpu::OpSTA, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0x96] = { "STX", &Cpu::OpSTX, &Cpu::AddrZPY, 4 };
    instructionLookupTable[0x98] = { "TYA", &Cpu::OpTYA, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0x99] = { "STA", &Cpu::OpSTA, &Cpu::AddrABY, 5 };
    instructionLookupTable[0x9A] = { "TXS", &Cpu::OpTXS, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0x9D] = { "STA", &Cpu::OpSTA, &Cpu::AddrABX, 5 };
    instructionLookupTable[0xA0] = { "LDY", &Cpu::OpLDY, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0xA1] = { "LDA", &Cpu::OpLDA, &Cpu::AddrIZX, 6 };
    instructionLookupTable[0xA2] = { "LDX", &Cpu::OpLDX, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0xA4] = { "LDY", &Cpu::OpLDY, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0xA5] = { "LDA", &Cpu::OpLDA, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0xA6] = { "LDX", &Cpu::OpLDX, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0xA8] = { "TAY", &Cpu::OpTAY, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0xA9] = { "LDA", &Cpu::OpLDA, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0xAA] = { "TAX", &Cpu::OpTAX, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0xAC] = { "LDY", &Cpu::OpLDY, &Cpu::AddrABS, 4 };
    instructionLookupTable[0xAD] = { "LDA", &Cpu::OpLDA, &Cpu::AddrABS, 4 };
    instructionLookupTable[0xAE] = { "LDX", &Cpu::OpLDX, &Cpu::AddrABS, 4 };
    instructionLookupTable[0xB0] = { "BCS", &Cpu::OpBCS, &Cpu::AddrREL, 2 };
    instructionLookupTable[0xB1] = { "LDA", &Cpu::OpLDA, &Cpu::AddrIZY, 5 };
    instructionLookupTable[0xB4] = { "LDY", &Cpu::OpLDY, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0xB5] = { "LDA", &Cpu::OpLDA, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0xB6] = { "LDX", &Cpu::OpLDX, &Cpu::AddrZPY, 4 };
    instructionLookupTable[0xB8] = { "CLV", &Cpu::OpCLV, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0xB9] = { "LDA", &Cpu::OpLDA, &Cpu::AddrABY, 4 };
    instructionLookupTable[0xBA] = { "TSX", &Cpu::OpTSX, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0xBC] = { "LDY", &Cpu::OpLDY, &Cpu::AddrABX, 4 };
    instructionLookupTable[0xBD] = { "LDA", &Cpu::OpLDA, &Cpu::AddrABX, 4 };
    instructionLookupTable[0xBE] = { "LDX", &Cpu::OpLDX, &Cpu::AddrABY, 4 };
    instructionLookupTable[0xC0] = { "CPY", &Cpu::OpCPY, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0xC1] = { "CMP", &Cpu::OpCMP, &Cpu::AddrIZX, 6 };
    instructionLookupTable[0xC4] = { "CPY", &Cpu::OpCPY, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0xC5] = { "CMP", &Cpu::OpCMP, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0xC6] = { "DEC", &Cpu::OpDEC, &Cpu::AddrZP0, 5 };
    instructionLookupTable[0xC8] = { "INY", &Cpu::OpINY, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0xC9] = { "CMP", &Cpu::OpCMP, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0xCA] = { "DEX", &Cpu::OpDEX, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0xCC] = { "CPY", &Cpu::OpCPY, &Cpu::AddrABS, 4 };
    instructionLookupTable[0xCD] = { "CMP", &Cpu::OpCMP, &Cpu::AddrABS, 4 };
    instructionLookupTable[0xCE] = { "DEC", &Cpu::OpDEC, &Cpu::AddrABS, 6 };
    instructionLookupTable[0xD0] = { "BNE", &Cpu::OpBNE, &Cpu::AddrREL, 2 };
    instructionLookupTable[0xD1] = { "CMP", &Cpu::OpCMP, &Cpu::AddrIZY, 5 };
    instructionLookupTable[0xD5] = { "CMP", &Cpu::OpCMP, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0xD6] = { "DEC", &Cpu::OpDEC, &Cpu::AddrZPX, 6 };
    instructionLookupTable[0xD8] = { "CLD", &Cpu::OpCLD, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0xD9] = { "CMP", &Cpu::OpCMP, &Cpu::AddrABY, 4 };
    instructionLookupTable[0xDD] = { "CMP", &Cpu::OpCMP, &Cpu::AddrABX, 4 };
    instructionLookupTable[0xDE] = { "DEC", &Cpu::OpDEC, &Cpu::AddrABX, 7 };
    instructionLookupTable[0xE0] = { "CPX", &Cpu::OpCPX, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0xE1] = { "SBC", &Cpu::OpSBC, &Cpu::AddrIZX, 6 };
    instructionLookupTable[0xE4] = { "CPX", &Cpu::OpCPX, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0xE5] = { "SBC", &Cpu::OpSBC, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0xE6] = { "INC", &Cpu::OpINC, &Cpu::AddrZP0, 5 };
    instructionLookupTable[0xE8] = { "INX", &Cpu::OpINX, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0xE9] = { "SBC", &Cpu::OpSBC, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0xEA] = { "NOP", &Cpu::OpNOP, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0xEC] = { "CPX", &Cpu::OpCPX, &Cpu::AddrABS, 4 };
    instructionLookupTable[0xED] = { "SBC", &Cpu::OpSBC, &Cpu::AddrABS, 4 };
    instructionLookupTable[0xEE] = { "INC", &Cpu::OpINC, &Cpu::AddrABS, 6 };
    instructionLookupTable[0xF0] = { "BEQ", &Cpu::OpBEQ, &Cpu::AddrREL, 2 };
    instructionLookupTable[0xF1] = { "SBC", &Cpu::OpSBC, &Cpu::AddrIZY, 5 };
    instructionLookupTable[0xF5] = { "SBC", &Cpu::OpSBC, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0xF6] = { "INC", &Cpu::OpINC, &Cpu::AddrZPX, 6 };
    instructionLookupTable[0xF8] = { "SED", &Cpu::OpSED, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0xF9] = { "SBC", &Cpu::OpSBC, &Cpu::AddrABY, 4 };
    instructionLookupTable[0xFD] = { "SBC", &Cpu::OpSBC, &Cpu::AddrABX, 4 };
    instructionLookupTable[0xFE] = { "INC", &Cpu::OpINC, &Cpu::AddrABX, 7 };

    //nops
    instructionLookupTable[0x04] = { "NOP", &Cpu::OpNOP, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0x0C] = { "NOP", &Cpu::OpNOP, &Cpu::AddrABS, 4 };
    instructionLookupTable[0x14] = { "NOP", &Cpu::OpNOP, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0x1A] = { "NOP", &Cpu::OpNOP, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0x1C] = { "NOP", &Cpu::OpNOP, &Cpu::AddrABX, 4 };
    instructionLookupTable[0x34] = { "NOP", &Cpu::OpNOP, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0x3A] = { "NOP", &Cpu::OpNOP, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0x3C] = { "NOP", &Cpu::OpNOP, &Cpu::AddrABX, 4 };
    instructionLookupTable[0x44] = { "NOP", &Cpu::OpNOP, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0x54] = { "NOP", &Cpu::OpNOP, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0x5A] = { "NOP", &Cpu::OpNOP, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0x5C] = { "NOP", &Cpu::OpNOP, &Cpu::AddrABX, 4 };
    instructionLookupTable[0x64] = { "NOP", &Cpu::OpNOP, &Cpu::AddrZP0, 3 };
    instructionLookupTable[0x74] = { "NOP", &Cpu::OpNOP, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0x7A] = { "NOP", &Cpu::OpNOP, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0x7C] = { "NOP", &Cpu::OpNOP, &Cpu::AddrABX, 4 };
    instructionLookupTable[0x80] = { "NOP", &Cpu::OpNOP, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0x82] = { "NOP", &Cpu::OpNOP, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0x89] = { "NOP", &Cpu::OpNOP, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0xC2] = { "NOP", &Cpu::OpNOP, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0xD4] = { "NOP", &Cpu::OpNOP, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0xDA] = { "NOP", &Cpu::OpNOP, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0xDC] = { "NOP", &Cpu::OpNOP, &Cpu::AddrABX, 4 };
    instructionLookupTable[0xE2] = { "NOP", &Cpu::OpNOP, &Cpu::AddrIMM, 2 };
    instructionLookupTable[0xF4] = { "NOP", &Cpu::OpNOP, &Cpu::AddrZPX, 4 };
    instructionLookupTable[0xFA] = { "NOP", &Cpu::OpNOP, &Cpu::AddrIMP, 2 };
    instructionLookupTable[0xFC] = { "NOP", &Cpu::OpNOP, &Cpu::AddrABX, 4 };
    
    //illegal instructions

}
